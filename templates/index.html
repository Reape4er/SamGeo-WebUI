<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GEOAI MAP</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <!-- Подключение стилей Leaflet -->
    <link
        rel="stylesheet"
        href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
        crossorigin=""
    />

    <!-- Подключение скрипта Leaflet -->
    <script
        src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin=""
    ></script>

    <!-- Подключение стилей и скрипта Leaflet.draw -->
    <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.css"
        integrity="sha512-gc3xjCmIy673V6MyOAZhIW93xhM9ei1I+gLbmFjUHIjocENRsLX/QUE1htk5q1XV2D/iie/VQ8DXI6Vu8bexvQ=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer"
    />
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.js"
        integrity="sha512-ozq8xQKq6urvuU6jNgkfqAmT7jKN2XumbrX1JiB3TnF7tI48DPI4Gy1GXKD/V3EExgAs1V+pRO7vwtS1LHg0Gw=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer"
    ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body>
    <div style="position: relative;">
        <div id="map" style="width: 100%; height: 100vh;"></div>

        <div style="position: absolute; bottom: 20px; left: 12px; z-index: 1000;">
            <div id="controls">
                <label for="box-threshold">Box Threshold:</label>
                <input type="range" id="box-threshold" name="box-threshold" min="0" max="1" step="0.01" value="0.21">
                <span id="box-threshold-value">0.21</span>

                <label for="text-threshold">Text Threshold:</label>
                <input type="range" id="text-threshold" name="text-threshold" min="0" max="1" step="0.01" value="0.21">
                <span id="text-threshold-value">0.21</span>

                <label for="text-prompt">Text Prompt:</label>
                <input type="text" id="text-prompt" name="text-prompt" placeholder="Enter your prompt here">

                <!-- Параметры для батчевого предсказания -->
                <label for="batch-prediction">
                    <input type="checkbox" id="batch-prediction" name="batch-prediction"> Batch Prediction
                </label>

                <div id="batch-params" style="display: none;">
                    <label for="tile-width">Tile Width:</label>
                    <input type="number" id="tile-width" name="tile-width" min="1" value="512">

                    <label for="tile-height">Tile Height:</label>
                    <input type="number" id="tile-height" name="tile-height" min="1" value="512">

                    <label for="overlap">Overlap (pixels):</label>
                    <input type="number" id="overlap" name="overlap" min="0" value="64">
                </div>

                <button id="submit-button" onclick="sendData()">Submit</button>
            </div>
            <!-- Добавляем панель управления слоями -->
            {% include 'style_controls.html' %}
        </div>
        <div style="position: absolute; bottom: 20px; right: 20px; z-index: 1000; background-color: rgba(255, 255, 255, 0.8); padding: 10px; border-radius: 5px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);">
            <h3>GeoJSON Layers</h3>
            <ul id="geojson-list" style="list-style-type: none; padding: 0;">
                <!-- Список будет заполняться динамически -->
            </ul>
            <button id="load-button" onclick="downloadSelectedLayers()">Скачать выбранные</button>
        </div>
    </div>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            font-family: 'Roboto', sans-serif;
        }
        #controls {
            background-color: rgba(255, 255, 255, 0.8);
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            margin-bottom: 12px;
        }

        #controls label {
            display: block;
            margin-top: 10px;
        }

        #controls input[type="range"] {
            width: 100%;
        }

        #submit-button {
            margin-top: 10px;
            padding: 5px 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        #submit-button:hover {
            background-color: #0056b3;
        }

        #batch-params label {
            margin-top: 5px;
        }

        #batch-params input[type="number"] {
            width: 100%;
        }
    </style>
</body>
</html>